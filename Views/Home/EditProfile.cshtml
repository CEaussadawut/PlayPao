@{
    ViewData["Title"] = "Edit Profile";
    var name = (string?)ViewBag.Name ?? "";
    var phone = (string?)ViewBag.Phone ?? "";
    var email = (string?)ViewBag.Email ?? "";
    var avatar = (string?)ViewBag.AvatarUrl ?? "/images/profile.png";
    var error = (string?)ViewBag.Error;
}

<div class="text-center">
    <h1 class="display-4">Edit Profile</h1>

    @if (!string.IsNullOrWhiteSpace(error))
    {
        <div
            style="color:#b91c1c;background:#fee2e2;border:1px solid #fecaca;padding:.5rem 1rem;border-radius:.5rem;max-width:560px;margin:.5rem auto;">
            @error
        </div>
    }

    <form asp-action="EditProfile" method="post"
        style="box-shadow:0 0 5px rgb(0 0 0 / .2); padding:1rem; border-radius:12px; max-width:560px; margin:1rem auto; text-align:left;">
        @Html.AntiForgeryToken()

        <div style="display:flex; align-items:center; gap:16px; margin-bottom:1rem;">
            <img src="@avatar" alt="avatar preview"
                style="width:72px; height:72px; border-radius:999px; object-fit:cover;">
            <div style="color:#6b7280;">Preview</div>
        </div>

        <div style="margin-bottom:.75rem;">
            <label for="name" style="display:block; font-weight:600;">Name</label>
            <input id="name" name="name" value="@name" required
                style="width:100%; padding:.5rem; border:1px solid #e5e7eb; border-radius:.5rem;" />
        </div>

        <div style="margin-bottom:.75rem;">
            <label for="phone" style="display:block; font-weight:600;">Phone</label>
            <input id="phone" name="phone" value="@phone" type="tel"
                style="width:100%; padding:.5rem; border:1px solid #e5e7eb; border-radius:.5rem;" />
        </div>

        <div style="margin-bottom:.75rem;">
            <label for="email" style="display:block; font-weight:600;">Email</label>
            <input id="email" name="email" value="@email"
                style="width:100%; padding:.5rem; border:1px solid #e5e7eb; border-radius:.5rem;" />
        </div>

        <div style="margin-bottom:.75rem;">
            <label for="avatarUrl" style="display:block; font-weight:600;">Avatar URL</label>
            <input id="avatarUrl" name="avatarUrl" value="@avatar" type="url"
                style="width:100%; padding:.5rem; border:1px solid #e5e7eb; border-radius:.5rem;" />
        </div>

        <div style="display:flex; gap:.5rem; margin-top:12px;">
            <button type="submit"
                style="background:#FF742B;color:#fff;border-radius:2rem;padding:.5rem 1rem;border:none;cursor:pointer;">
                Save
            </button>
            <a asp-action="Profile"
                style="border:1px solid #e5e7eb;border-radius:12px;text-decoration:none;padding:.5rem 1rem;color:#111;">
                Cancel
            </a>
        </div>
    </form>
</div>

<script>
    document.currentScript?.previousElementSibling?.addEventListener('submit', e => {
        if (!e.target.checkValidity()) { e.preventDefault(); e.target.reportValidity(); }
    });
</script>