@{
    ViewData["Title"] = "Home Page";
    var currentUser = Context.Session.GetString("User");
}
@using System.Globalization
@model IEnumerable<Event>

<div class="flex flex-col gap-1 text-center">
    <div class="flex items-center gap-1">
        <input class="input-theme-full" type="text" placeholder="Search">
        @if (!string.IsNullOrWhiteSpace(currentUser))
        {
            <div class="top-bar" style="margin-top: 0.75rem;">
                <div class="notification-area">
                    <a href="#" class="notification-icon" onclick="toggleNotificationBox()">
                        <i data-lucide="bell"></i>
                        <span class="badge" id="notification-badge" style="display: none;">0</span>
                    </a>

                    <div class="notification-box hidden" id="notification-box">
                        <div class="notification-header">
                            <h3>Notifications</h3>
                            <button onclick="toggleNotificationBox()">×</button>
                        </div>
                        <div class="notification-list" id="notification-list">
                            <!-- Notifications will be loaded here -->
                        </div>
                        <div class="notification-footer">
                            <a asp-controller="Notification" asp-action="Index">View All</a>
                        </div>
                    </div>
                </div>
            </div>
        }
    </div>

    @if (Model != null && Model.Any())
    {
        @foreach (var eventItem in Model)
        {
            <a href="@Url.Action("Detail", "Event", new { id = eventItem.Id })" style="text-decoration: none; color: inherit;">
                <div style="display: flex; box-shadow: 0 0 5px rgb(0 0 0 / 0.2); padding: 1rem; border-radius: 0.5rem;">
                    <img src="@(string.IsNullOrEmpty(eventItem.ImagePath) ? "https://i.ytimg.com/vi/N_Fb4x-OAzE/oardefault.jpg" : eventItem.ImagePath)"
                        alt="" style="height: 110px; width: 200px; border-radius: 8px;">
                    <div
                        style="padding-top: 8px; padding-bottom: 8px; padding-right: 14px; padding-left: 14px; gap: 8px; width: 100%; margin-right: 8px">
                        <h5 style="color: #FF742B">@eventItem.Date.ToString("dddd, MMMM d, yyyy")
                            @eventItem.Time.Hours.ToString("D2"):@eventItem.Time.Minutes.ToString("D2") -
                            @eventItem.EndTime.Hours.ToString("D2"):@eventItem.EndTime.Minutes.ToString("D2")</h5>
                        <h3>@eventItem.Title</h3>
                        <p>@eventItem.Description</p>
                        <p style="font-size: 0.8em; color: #666;">Created by: @eventItem.Creator</p>
                    </div>
                    <div class="flex flex-col justify-between items-end">
                        <i data-lucide="bookmark"></i>
                        <p style="width: 126px; text-align: right;">@eventItem.CurrentMembers / @eventItem.Member</p>
                        <div class="flex gap-2">
                         @if (!string.IsNullOrEmpty(currentUser) && currentUser != eventItem.Creator)
                         {
                            <button class="px-2 py-1 text-sm"
                                style="background-color: #FF742B; color: white; border-radius: 2rem;">join</button>
                         }
                             else if (currentUser == eventItem.Creator)
                         {
                            <span style="font-style: italic; color: #666; width: 126px; text-align: right;">Created by you</span>
                        }
                        </div>
                       
                    </div>
                </div>
            </a>
        }
    }
    else
    {
        <p>No events available.</p>
    }
</div>